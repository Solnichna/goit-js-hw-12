{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport axios from 'axios';\n\nconst form = document.querySelector(\".form\");\nconst gallery = document.querySelector(\".gallery\");\nconst container = document.querySelector(\"div\");\nconst inputDate = document.querySelector(\"input\");\nconst loadMoreBtn = document.createElement('button');\nloadMoreBtn.textContent = 'Load more';\nloadMoreBtn.classList.add('load-more-btn');\ncontainer.append(loadMoreBtn);\n\nlet currentPage = 1;\nlet searchTerm = '';\nlet totalHits = 0;\nlet cardHeight = 0;\nlet lightbox = null; \n\nconst showLoader = () => {\n  const loader = document.createElement('span');\n  loader.classList.add('loader');\n  container.insertBefore(loader, loadMoreBtn);\n};\n\nconst hideLoader = () => {\n  const loader = document.querySelector('.loader');\n  if (loader) {\n    loader.remove();\n  }\n};\n\nconst showLoadMoreButton = () => {\n  loadMoreBtn.style.display = 'block';\n};\n\nconst hideLoadMoreButton = () => {\n  loadMoreBtn.style.display = 'none';\n};\n\nform.addEventListener(\"submit\", async (event) => {\n  event.preventDefault();\n  searchTerm = inputDate.value;\n  showLoader();\n  currentPage = 1;\n  gallery.innerHTML = \"\";\n  try {\n    await searchImages();\n  } catch (error) {\n    console.error(error);\n    iziToast.error({\n      message: 'An error occurred while fetching images. Please try again later.',\n      position: 'center',\n      transitionIn: \"fadeInLeft\",\n    });\n  }\n  hideLoader();\n});\n\nloadMoreBtn.addEventListener('click', async () => {\n  currentPage++;\n  showLoader();\n  try {\n    await searchImages();\n  } catch (error) {\n    console.error(error);\n    iziToast.error({\n      message: 'An error occurred while fetching images. Please try again later.',\n      position: 'center',\n      transitionIn: \"fadeInLeft\",\n    });\n  }\n  hideLoader();\n});\n\nasync function searchImages() {\n  const apiKey = '42288638-d7f8a30b0a31b090439479823';\n  const perPage = 15;\n  const url = `https://pixabay.com/api/?key=${apiKey}&q=${searchTerm}&image_type=photo&orientation=horizontal&safesearch=true&page=${currentPage}&per_page=${perPage}`;\n  try {\n    const response = await axios.get(url);\n    const data = response.data;\n    totalHits = data.totalHits;\n    if (data.hits.length === 0) {\n      iziToast.error({\n        message: 'Sorry, there are no images matching your search query. Please try again!',\n        position: 'center',\n        transitionIn: \"fadeInLeft\",\n      });\n    } else {\n      const markup = data.hits\n        .map(data => {\n          return `\n          <li class=\"gallery-item\"><a href=\"${data.largeImageURL}\">\n          <img class=\"gallery-image\" src=\"${data.webformatURL}\" alt=\"${data.tags}\"></a>\n          <p><b>Likes: </b>${data.likes}</p>\n          <p><b>Views: </b>${data.views}</p>\n          <p><b>Comments: </b>${data.comments}</p>\n          <p><b>Downloads: </b>${data.downloads}</p>\n          </li>`;\n        }).join('');\n      gallery.insertAdjacentHTML(\"beforeend\", markup);\n      if (lightbox === null) {\n        \n        lightbox = new SimpleLightbox('.gallery a', {\n          captions: true,\n          captionType: 'attr',\n          captionsData: 'alt',\n          captionPosition: 'bottom',\n          fadeSpeed: 150,\n          captionSelector: \"img\",\n          captionDelay: 250,\n        });\n      } else {\n        \n        lightbox.refresh();\n      }\n      showLoadMoreButton();\n      if (gallery.querySelectorAll('.gallery-item').length >= totalHits) {\n        hideLoadMoreButton();\n        iziToast.info({\n          message: \"We're sorry, but you've reached the end of search results.\",\n          position: 'center',\n          transitionIn: \"fadeInLeft\",\n        });\n      }\n      if (cardHeight === 0) {\n        const card = gallery.querySelector('.gallery-item');\n        cardHeight = card.getBoundingClientRect().height;\n      }\n      window.scrollBy({\n        top: cardHeight * 2,\n        behavior: 'smooth'\n      });\n    }\n  } catch (error) {\n    throw new Error(error.message);\n  }\n}\n"],"names":["form","gallery","container","inputDate","loadMoreBtn","currentPage","searchTerm","totalHits","cardHeight","lightbox","showLoader","loader","hideLoader","showLoadMoreButton","hideLoadMoreButton","event","searchImages","error","iziToast","url","data","axios","markup","SimpleLightbox"],"mappings":"owBAMA,MAAMA,EAAO,SAAS,cAAc,OAAO,EACrCC,EAAU,SAAS,cAAc,UAAU,EAC3CC,EAAY,SAAS,cAAc,KAAK,EACxCC,EAAY,SAAS,cAAc,OAAO,EAC1CC,EAAc,SAAS,cAAc,QAAQ,EACnDA,EAAY,YAAc,YAC1BA,EAAY,UAAU,IAAI,eAAe,EACzCF,EAAU,OAAOE,CAAW,EAE5B,IAAIC,EAAc,EACdC,EAAa,GACbC,EAAY,EACZC,EAAa,EACbC,EAAW,KAEf,MAAMC,EAAa,IAAM,CACvB,MAAMC,EAAS,SAAS,cAAc,MAAM,EAC5CA,EAAO,UAAU,IAAI,QAAQ,EAC7BT,EAAU,aAAaS,EAAQP,CAAW,CAC5C,EAEMQ,EAAa,IAAM,CACvB,MAAMD,EAAS,SAAS,cAAc,SAAS,EAC3CA,GACFA,EAAO,OAAM,CAEjB,EAEME,EAAqB,IAAM,CAC/BT,EAAY,MAAM,QAAU,OAC9B,EAEMU,EAAqB,IAAM,CAC/BV,EAAY,MAAM,QAAU,MAC9B,EAEAJ,EAAK,iBAAiB,SAAU,MAAOe,GAAU,CAC/CA,EAAM,eAAc,EACpBT,EAAaH,EAAU,MACvBO,IACAL,EAAc,EACdJ,EAAQ,UAAY,GACpB,GAAI,CACF,MAAMe,EAAY,CACnB,OAAQC,EAAP,CACA,QAAQ,MAAMA,CAAK,EACnBC,EAAS,MAAM,CACb,QAAS,mEACT,SAAU,SACV,aAAc,YACpB,CAAK,CACF,CACDN,GACF,CAAC,EAEDR,EAAY,iBAAiB,QAAS,SAAY,CAChDC,IACAK,IACA,GAAI,CACF,MAAMM,EAAY,CACnB,OAAQC,EAAP,CACA,QAAQ,MAAMA,CAAK,EACnBC,EAAS,MAAM,CACb,QAAS,mEACT,SAAU,SACV,aAAc,YACpB,CAAK,CACF,CACDN,GACF,CAAC,EAED,eAAeI,GAAe,CAG5B,MAAMG,EAAM,qEAA4Cb,kEAA2ED,cAAwB,KAC3J,GAAI,CAEF,MAAMe,GADW,MAAMC,EAAM,IAAIF,CAAG,GACd,KAEtB,GADAZ,EAAYa,EAAK,UACbA,EAAK,KAAK,SAAW,EACvBF,EAAS,MAAM,CACb,QAAS,2EACT,SAAU,SACV,aAAc,YACtB,CAAO,MACI,CACL,MAAMI,EAASF,EAAK,KACjB,IAAIA,GACI;AAAA,8CAC6BA,EAAK;AAAA,4CACPA,EAAK,sBAAsBA,EAAK;AAAA,6BAC/CA,EAAK;AAAA,6BACLA,EAAK;AAAA,gCACFA,EAAK;AAAA,iCACJA,EAAK;AAAA,gBAE7B,EAAE,KAAK,EAAE,EACZnB,EAAQ,mBAAmB,YAAaqB,CAAM,EAC1Cb,IAAa,KAEfA,EAAW,IAAIc,EAAe,aAAc,CAC1C,SAAU,GACV,YAAa,OACb,aAAc,MACd,gBAAiB,SACjB,UAAW,IACX,gBAAiB,MACjB,aAAc,GACxB,CAAS,EAGDd,EAAS,QAAO,EAElBI,IACIZ,EAAQ,iBAAiB,eAAe,EAAE,QAAUM,IACtDO,IACAI,EAAS,KAAK,CACZ,QAAS,6DACT,SAAU,SACV,aAAc,YACxB,CAAS,GAECV,IAAe,IAEjBA,EADaP,EAAQ,cAAc,eAAe,EAChC,sBAAuB,EAAC,QAE5C,OAAO,SAAS,CACd,IAAKO,EAAa,EAClB,SAAU,QAClB,CAAO,CACF,CACF,OAAQS,EAAP,CACA,MAAM,IAAI,MAAMA,EAAM,OAAO,CAC9B,CACH"}